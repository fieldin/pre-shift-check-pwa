<!--
  Select Asset Component Template
  
  Asset selection screen with search and QR code support.
  Shows list of cached assets for manual selection.
-->

<div class="select-asset-page">
  <!-- Header with back navigation -->
  <header class="header">
    <button class="back-btn" routerLink="/">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    <h1>Select Asset</h1>
  </header>

  <!-- QR Code Info Section -->
  <div class="qr-section">
    <div class="qr-icon">üì∑</div>
    <div class="qr-text">
      <p class="qr-title">Scan QR Code</p>
      <p class="qr-subtitle">Or search manually below</p>
    </div>
  </div>

  <!-- Error Message -->
  @if (errorMessage()) {
    <div class="alert alert-error">
      <span class="alert-icon">‚ö†Ô∏è</span>
      <span class="alert-text">{{ errorMessage() }}</span>
    </div>
  }

  <!-- Search Input -->
  <div class="search-section">
    <div class="search-wrapper">
      <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="M21 21l-4.35-4.35"/>
      </svg>
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (input)="onSearch()"
        placeholder="Search by name, ID, or type..."
        class="search-input"
      />
      @if (searchQuery) {
        <button class="clear-btn" (click)="clearSearch()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      }
    </div>
  </div>

  <!-- Asset List -->
  <div class="asset-list">
    <!-- Empty State -->
    @if (filteredAssets().length === 0 && !loading()) {
      <div class="empty-state">
        @if (searchQuery) {
          <p>No assets match "{{ searchQuery }}"</p>
        } @else {
          <p>No assets cached</p>
          <p class="empty-hint">Sync data from the dashboard</p>
        }
      </div>
    }

    <!-- Asset Cards -->
    @for (asset of filteredAssets(); track asset.asset_id) {
      <button class="asset-card" (click)="selectAsset(asset)">
        <div class="asset-icon">{{ utils.getAssetIcon(asset.machine_class) }}</div>
        <div class="asset-info">
          <span class="asset-name">{{ asset.name }}</span>
          <span class="asset-meta">{{ asset.asset_id }} ¬∑ {{ asset.machine_class }}</span>
        </div>
        <svg class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 18l6-6-6-6"/>
        </svg>
      </button>
    }
  </div>

  <!-- Loading Overlay -->
  @if (loading()) {
    <div class="loading-overlay">
      <div class="loading-spinner">‚è≥</div>
      <span>Checking asset...</span>
    </div>
  }
</div>

